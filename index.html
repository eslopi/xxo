<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù…Ø§ÙƒÙ†</title>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.css" rel="stylesheet" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js"></script>
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      direction: rtl;
      background-color: #f4f4f4;
      color: #333;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      display: flex;
      width: 100%;
      max-width: 100%;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      height: 100vh;
    }
    #map-container {
      width: 50%;
      position: relative;
      height: 100%;
    }
    #map {
      height: 100%;
      width: 100%;
    }
    #locateButton {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 1;
      background-color: #0f3460;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #locateButton:hover {
      background-color: #0d2c50;
    }
    #info-container {
      width: 50%;
      padding: 20px;
      background-color: #f9f9f9;
      border-radius: 5px;
      overflow-y: auto;
      height: 100%;
    }
    #place-info {
      display: none;
    }
    #place-info img {
      max-width: 100%;
      height: auto;
      border-radius: 5px;
    }
    .chat-button {
      margin-top: 10px;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
      font-size: 16px;
    }
    #botChat {
      background-color: #0f3460;
      color: white;
    }
    #botChat:hover {
      background-color: #0d2c50;
    }
    #liveChat {
      background-color: #00b894;
      color: white;
    }
    #liveChat:hover {
      background-color: #009f73;
    }
  </style>

  <!-- Firebase CDN -->
  <script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-firestore-compat.js"></script>
</head>
<body>

  <div class="container">
    <!-- Ø§Ù„Ù†ØµÙ Ø§Ù„Ø£ÙŠÙ…Ù† Ù„Ù„Ø®Ø±ÙŠØ·Ø© -->
    <div id="map-container">
      <!-- Ø²Ø± Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ -->
      <button id="locateButton">ğŸ“ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
      <!-- Ø®Ø±ÙŠØ·Ø© Ù…Ø§Ø¨ Ø¨ÙˆÙƒØ³ -->
      <div id="map"></div>
    </div>

    <!-- Ø§Ù„Ù†ØµÙ Ø§Ù„Ø£ÙŠØ³Ø± Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† -->
    <div id="info-container">
      <h1>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙƒØ§Ù†</h1>
      <div id="place-info">
        <h3 id="place-name"></h3>
        <p id="place-description"></p>
        <img id="place-image" src="" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…ÙƒØ§Ù†">
        
        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© -->
        <button id="botChat" class="chat-button">ğŸ›  MS|MV Ù…Ø³Ø§Ø¹Ø¯ Ø¨ÙˆØª</button>
        <button id="liveChat" class="chat-button">ğŸ’¬ Ø¯Ø±Ø¯Ø´Ø© Ø­ÙŠØ© Ù…Ø¹ Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙŠÙ†</button>
      </div>
      <p id="no-selection">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£Ø­Ø¯ Ø§Ù„Ù…Ø§Ø±ÙƒØ±Ø§Øª Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª.</p>
    </div>
  </div>

  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAzNFMx0l3x-1qSB7zYEHJwasBnkPOfpg0",
      authDomain: "ms-mv-71de8.firebaseapp.com",
      projectId: "ms-mv-71de8",
      storageBucket: "ms-mv-71de8.appspot.com",
      messagingSenderId: "11803494011",
      appId: "1:11803494011:web:313992c0215928cb3b44de",
      measurementId: "G-XKKEK82ZPD"
    };

    // ØªÙ‡ÙŠØ¦Ø© Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ØªÙ‡ÙŠØ¦Ø© Mapbox
    mapboxgl.accessToken = 'pk.eyJ1IjoiZXNsb3BpIiwiYSI6ImNtMWV6OHI3eDFoeGMybHF6bmR0OXcwbWIifQ.PgBVsl5bPmcOQ_47NDK10A';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      center: [46.6753, 24.7136], // Ø§Ù„Ø±ÙŠØ§Ø¶
      zoom: 10
    });

    // Ø¬Ù„Ø¨ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù…Ø¶Ø§ÙØ© Ù…Ù† Firestore
    db.collection("places").get().then((querySnapshot) => {
      querySnapshot.forEach((doc) => {
        var place = doc.data();
        addPlaceMarker(place.name, place.description, place.latitude, place.longitude, place.imageUrl);
      });
    });

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø±ÙƒØ± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
    function addPlaceMarker(name, description, latitude, longitude, imageUrl) {
      var marker = new mapboxgl.Marker()
        .setLngLat([longitude, latitude])
        .addTo(map);

      // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø§Ø±ÙƒØ±
      marker.getElement().addEventListener('click', function() {
        document.getElementById('place-info').style.display = 'block';
        document.getElementById('place-name').textContent = name;
        document.getElementById('place-description').textContent = description;
        document.getElementById('place-image').src = imageUrl;
        document.getElementById('place-image').alt = name;
        document.getElementById('no-selection').style.display = 'none';

        // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ù…Ø¹ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
        document.getElementById('botChat').addEventListener('click', function() {
          alert("Ø³ÙŠØªÙ… ÙØªØ­ MS|MV Ù…Ø³Ø§Ø¹Ø¯ Ø¨ÙˆØª Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙƒØ§Ù†.");
        });

        document.getElementById('liveChat').addEventListener('click', function() {
          alert("Ø³ÙŠØªÙ… ÙØªØ­ Ø¯Ø±Ø¯Ø´Ø© Ø­ÙŠØ© Ù…Ø¹ Ø§Ù„Ø£Ø´Ø®Ø§Øµ Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙŠÙ† ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙƒØ§Ù†.");
        });
      });
    }

    // Ø²Ø± Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
    document.getElementById('locateButton').addEventListener('click', function() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var lat = position.coords.latitude;
          var lon = position.coords.longitude;

          // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
          map.flyTo({
            center: [lon, lat],
            zoom: 14
          });

          // Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø±ÙƒØ± ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
          new mapboxgl.Marker()
            .setLngLat([lon, lat])
            .addTo(map);
        }, function() {
          alert('ØºÙŠØ± Ù‚Ø§Ø¯Ø± Ø¹Ù„Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ù…ØªØµÙØ­Ùƒ.');
        });
      } else {
        alert('Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ.');
      }
    });
  </script>
</body>
</html>
